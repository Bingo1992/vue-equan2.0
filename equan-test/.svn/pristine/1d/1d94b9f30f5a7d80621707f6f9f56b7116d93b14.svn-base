webpackJsonp([12],{K2tD:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("Dd8w"),i=e.n(a),r=e("NYxO"),o=e("KgXo"),c=e("BzkK"),n=e("P9l9"),l=e("VKKs"),d=e("Dqno"),h={name:"orderConfirm",data:function(){return{showLoading:!1,proList:[],unCheckCartList:[],address:[],paramsList:[],remark:"",curAdsId:0,total_price2:0,total_ebuy:0,userEbuy:0,userIntegeral:0,failPay:!1,alertText:"",showAlertTip:!1,flag:!1,formLoading:!1,pay:{egou:0,ebi:0,money:0}}},components:{loading:o.a,alertTip:c.a},mixins:[d.b,d.c],created:function(){document.title="订单确认",this._initData()},computed:i()({},Object(r.c)(["chooseAddress","addressId","cartList"])),methods:i()({},Object(r.b)(["CHOOSE_ADDRESS","INIT_BUYCART"]),{_initData:function(){var t=this;this.proList=JSON.parse(Object(l.a)("buyPro")),Object(l.a)("unCheckCartList")||(this.cartList.forEach(function(s,e){s.check||t.unCheckCartList.push(s)}),Object(l.c)("unCheckCartList",this.unCheckCartList));var s=0;this.proList.forEach(function(e,a){2==e.type&&s++;var i=e.productId+":"+e.total;t.paramsList.push(i)}),s==this.proList.length&&(this.flag=!0),this._initAddress(),this.calcTotalMoney(),this._getUserTotal()},calcTotalMoney:function(){var t=this;return this.total_price2=0,this.proList&&this.proList.forEach(function(s,e){t.total_price2+=s.total*s.currCost}),Number(this.total_price2)},calcTotalEbuy:function(){var t=this;return this.total_ebuy=0,this.proList&&this.proList.forEach(function(s,e){1==s.ebuy&&(t.total_ebuy+=s.total*s.currCost)}),Number(this.total_ebuy)},_getUserTotal:function(){var t=this;Object(n.r)().then(function(s){if(t.userEbuy=s.userEbuy,t.userIntegeral=s.userIntegeral,t.userEbuy)if(t.userEbuy>=t.calcTotalEbuy()){t.pay.egou=t.calcTotalEbuy();var e=t.calcTotalMoney()-t.calcTotalEbuy();t.integeralPay(t.userIntegeral,e)}else{t.pay.egou=t.userEbuy;var a=t.calcTotalMoney()-t.userEbuy;t.integeralPay(t.userIntegeral,a)}else t.integeralPay(t.userIntegeral,t.calcTotalMoney())})},integeralPay:function(t,s){t?t>=s?this.pay.ebi=s:(this.pay.ebi=t,this.pay.money=s-t):this.pay.money=s},gotoPay1:function(){var t=this;if(0===this.chooseAddress.length)this.showHideAlert("请添加地址");else{this.showAlertTip=!0,this.formLoading=!0,this.alertText="提交中，请稍候";var s="{"+this.paramsList.join(",")+"}";Object(n.o)({params:{addressid:this.curAdsId,params:s,remark:this.remark}}).then(function(s){0==s.success?t.showHideAlert(s.msg):Number(s.attributes.wxPayTotal)>0?(window.location.href=t.getUrlPath("/pay.html?orderNo="+s.attributes.payOrderId),Object(l.c)("buyCart",Object(l.a)("unCheckCartList")),t.INIT_BUYCART()):(t.$router.push("/result"),Object(l.c)("buyCart",Object(l.a)("unCheckCartList")),t.INIT_BUYCART())})}},_initAddress:function(){var t=this;0===this.chooseAddress.length?Object(n.d)().then(function(s){t.address=s.resultList,t.address.length>0&&t.address.forEach(function(s,e){1==s.isdefault&&(t.CHOOSE_ADDRESS({address:s,id:s.id,index:e}),t.curAdsId=s.id)})}):this.curAdsId=this.addressId},showHideAlert:function(t){var s=this;this.formLoading=!1,this.showAlertTip=!0,this.alertText=t,setTimeout(function(){s.showAlertTip=!1},1e3)}}),watch:{$route:"_initData"}},u={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"orderConfirm banner-b"},[t.showLoading?e("loading"):t._e(),t._v(" "),t.showLoading?t._e():e("section",[e("div",{staticClass:"logistics bg-show"},[e("router-link",{staticClass:"list-box",attrs:{to:"/chooseAddress"}},[e("i",{staticClass:"icon-map font-gray pdr"}),t._v(" "),0===t.chooseAddress.length?e("h5",{staticClass:"list-info-v pdt pdb"},[t._v("请添加一个收货地址")]):e("div",{staticClass:"list-info-v"},[e("div",[e("h4",[e("span",{staticClass:"pdr"},[t._v(t._s(t.chooseAddress.username))]),t._v(" "),e("span",[t._v(t._s(t.chooseAddress.mobile))])]),t._v(" "),e("p",{staticClass:"font-gray nowrap-2"},[t._v(t._s(t.chooseAddress.province)+t._s(t.chooseAddress.city)+t._s(t.chooseAddress.district)+t._s(t.chooseAddress.detailaddress))])])]),t._v(" "),e("i",{staticClass:"icon-right"})])],1),t._v(" "),e("ul",{staticClass:"confirm-order"},t._l(t.proList,function(s,a){return e("li",{key:a,staticClass:"list-box border-bottom"},[e("img",{staticClass:"list-img",attrs:{src:t.getImgPath(s.productImg)}}),t._v(" "),e("div",{staticClass:"list-info-v"},[e("div",[e("div",{staticClass:"list-box"},[e("div",{staticClass:"list-info-h"},[e("h5",{staticClass:"nowrap-2 top-text"},[t._v(t._s(s.productName))])]),t._v(" "),e("h5",{staticClass:"pdl"},[t._v("X"+t._s(s.total))])]),t._v(" "),e("div",{staticClass:"price-big"},[e("span",{staticClass:"font-orange"},[e("i",{staticClass:"icon-coin"}),t._v(t._s(s.currCost))]),t._v(" "),e("s",{staticClass:"font-gray"},[t._v("市场价：￥"+t._s(s.currPrice))])])])])])})),t._v(" "),e("div",{staticClass:"bg-mgShow"},[t._m(0),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.remark,expression:"remark"}],staticClass:"txtArea",attrs:{cols:"30",rows:"3",placeholder:"请输入留言"},domProps:{value:t.remark},on:{input:function(s){s.target.composing||(t.remark=s.target.value)}}})]),t._v(" "),0!=t.pay.egou?e("div",{staticClass:"bg-mgShow"},[t._m(1),t._v(" "),e("ul",[e("li",{staticClass:"list-box"},[e("p",{staticClass:"list-info-h"},[t._v("可用e购账户抵扣"),e("span",{staticClass:"font-red"},[t._v(t._s(t.pay.egou))]),t._v("元")]),t._v(" "),t._m(2)])])]):t._e(),t._v(" "),0!=t.pay.money||0!=t.pay.ebi?e("div",{staticClass:"bg-mgShow"},[t._m(3),t._v(" "),e("ul",[0!=t.pay.ebi?e("li",{staticClass:"list-box"},[e("p",{staticClass:"list-info-h"},[t._v("e币支付"),e("span",{staticClass:"pdr font-orange"},[e("i",{staticClass:"icon-coin"}),t._v(t._s(t.pay.ebi))])]),t._v(" "),t._m(4)]):t._e(),t._v(" "),0!=t.pay.money?e("li",{staticClass:"list-box"},[e("p",{staticClass:"list-info-h"},[t._v("微信支付"),e("span",{staticClass:" font-orange"},[t._v("￥"+t._s(t.pay.money))])]),t._v(" "),t._m(5)]):t._e()])]):t._e(),t._v(" "),e("div",{staticClass:"fixed-bottom  bg-gray"},[e("div",{staticClass:"cal-banner list-box border-top"},[e("div",{staticClass:"list-info-v"},[e("div",[0!=t.pay.money?e("p",[t._v("\n                      应付现金：\n                      "),e("span",{staticClass:"font-orange"},[t._v("￥"+t._s(t.pay.money))])]):t._e(),t._v(" "),t.userIntegeral&&0!=t.userIntegeral?e("p",[t._v("\n                      应付e币：\n                      "),e("i",{staticClass:"icon-coin"}),t._v(" "),e("span",{staticClass:"font-orange"},[t._v(t._s(t.pay.ebi))])]):t._e()])]),t._v(" "),e("button",{staticClass:"btn-theme",on:{click:t.gotoPay1}},[t._v(" 立即付款")])])])]),t._v(" "),e("alert-tip",{directives:[{name:"show",rawName:"v-show",value:t.showAlertTip,expression:"showAlertTip"}],attrs:{formLoading:t.formLoading,alertText:t.alertText}})],1)},staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"title-bar border-bottom"},[s("h5",[this._v("给卖家留言")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"title-bar border-bottom"},[s("h5",[this._v("使用e购账户")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("label",{staticClass:"checkbox"},[s("input",{attrs:{type:"radio",checked:"",disabled:""}}),this._v(" "),s("i",{staticClass:"icon-hook"})])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"title-bar border-bottom"},[s("h5",[this._v("支付方式")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("label",{staticClass:"checkbox"},[s("input",{attrs:{type:"radio",checked:"",disabled:""}}),this._v(" "),s("i",{staticClass:"icon-hook"})])},function(){var t=this.$createElement,s=this._self._c||t;return s("label",{staticClass:"checkbox"},[s("input",{attrs:{type:"radio",checked:"",disabled:""}}),this._v(" "),s("i",{staticClass:"icon-hook"})])}]};var _=e("VU/8")(h,u,!1,function(t){e("oei6")},"data-v-ed21767e",null);s.default=_.exports},oei6:function(t,s){}});
//# sourceMappingURL=12.2a4b117cc78095a3cad7.js.map