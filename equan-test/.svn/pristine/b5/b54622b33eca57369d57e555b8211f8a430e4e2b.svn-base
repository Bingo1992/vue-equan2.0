webpackJsonp([10],{AOoF:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var c=s("Dd8w"),e=s.n(c),a=s("NYxO"),n=s("mzkE"),o=s("bcEp"),l={data:function(){return{num:this.proNum,limit:999,showNumDialog:!1}},props:{proNum:{type:[Number],default:1},proID:{type:[Number,String]},check:{type:[String,Boolean]}},methods:{up:function(){this.changeNum("up")},down:function(){this.changeNum("down")},changeNum:function(t){"up"===t?this.num++:this.num--,this.$emit("editNum",this.proID,this.num,this.check)},confirmBtn:function(){this.num=this.num>this.limit?Number(this.limit):Number(this.num),(this.num<1||""==this.num)&&(this.num=1),this.$emit("editNum",this.proID,this.num,this.check),this.showNumDialog=!1},showDialog:function(){this.showNumDialog=!0},closeDialog:function(){this.showNumDialog=!1}}},r={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"amount"},[s("span",{class:["minus","icon-minus",t.num<=1?"dis-btn":""],on:{touchstart:function(i){t.down()}}}),t._v(" "),s("span",{staticClass:"count",on:{click:function(i){t.showDialog()}}},[t._v(t._s(t.num))]),t._v(" "),s("span",{staticClass:"plus icon-plus",on:{touchstart:function(i){t.up()}}}),t._v(" "),t.showNumDialog?s("div",{staticClass:"ui-dialog"},[s("div",{staticClass:"dialog-cnt"},[s("div",{staticClass:"center-text"},[s("h5",{staticClass:"pdt"},[t._v("购买数量")]),t._v(" "),s("div",{staticClass:"amount"},[s("span",{class:["minus","icon-minus",t.num<=1?"dis-btn":""],on:{touchstart:function(i){t.down()}}}),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.num,expression:"num",modifiers:{number:!0}}],staticClass:"count",attrs:{type:"number",maxlength:"3"},domProps:{value:t.num},on:{input:function(i){i.target.composing||(t.num=t._n(i.target.value))},blur:function(i){t.$forceUpdate()}}}),t._v(" "),s("span",{staticClass:"plus icon-plus",on:{touchstart:function(i){t.up()}}})])]),t._v(" "),s("div",{staticClass:"two-btn"},[s("a",{staticClass:"btn-cancel",on:{click:t.closeDialog}},[t._v("取消")]),t._v(" "),s("a",{staticClass:"btn-theme",on:{click:t.confirmBtn}},[t._v("确定")])])])]):t._e()])},staticRenderFns:[]};var u=s("VU/8")(l,r,!1,function(t){s("fjE2")},"data-v-c6a2a97a",null).exports,h=s("Dqno"),m=s("P9l9"),d=s("VKKs"),f={name:"cart",data:function(){return{edit:!1,checkID:[],isCheckAll:!0,flag:!0,showDialog:!1,confirmTitle:"",confirmText:"",checks:[],cartNum:0,total_ebuy:0,total_price2:0,userEbuy:0,userIntegeral:0,hasEbuy:0,pay:{egou:0,ebi:0,money:0}}},components:{FooterNav:n.a,confirmDialog:o.a,buyNum:u},mixins:[h.b],mounted:function(){document.title="购物车",this.initData()},computed:e()({},Object(a.c)(["cartList"]),{checkAllFlag:function(){return this.checkedCount===this.cartList.length?this.isCheckAll=!0:this.isCheckAll=!1,this.isCheckAll},checkedCount:function(){var t=this,i=0;return this.checkID=[],this.cartList&&this.cartList.forEach(function(s){s.check&&(i++,t.checkID.push(s.productId))}),Number(i)}}),methods:e()({},Object(a.b)(["INIT_BUYCART","EDIT_CART","DELETE_CART"]),{initData:function(){this._getUserTotal()},_editCart:function(t,i,s){var c=this;Object(m.d)({quality:i},t).then(function(e){c.EDIT_CART({productid:t,quality:i,check:s}),c.calcuPay()})},editNum:function(t,i,s){this._editCart(t,i,s)},selectPro:function(t,i,s){this.calcuPay(),this.EDIT_CART({productid:t,quality:i,check:s})},selectAll:function(){var t=!this.checkAllFlag;this.EDIT_CART({check:t}),this.calcuPay()},editPro:function(){this.edit?this.edit=!1:this.edit=!0},calcTotalMoney:function(){var t=this;return this.total_price2=0,this.cartList&&this.cartList.forEach(function(i,s){i.check&&(t.total_price2+=i.total*i.currCost)}),Number(this.total_price2)},calcTotalEbuy:function(){var t=this;return this.total_ebuy=0,this.cartList&&this.cartList.forEach(function(i,s){i.check&&1==i.ebuy&&(t.total_ebuy+=i.total*i.currCost)}),Number(this.total_ebuy)},_getUserTotal:function(){var t=this;Object(m.y)().then(function(i){t.userEbuy=i.userEbuy,t.userIntegeral=i.userIntegeral,t.calcuPay()})},calcuPay:function(){if(this.pay.egou=0,this.pay.ebi=0,this.pay.money=0,this.userEbuy)if(this.userEbuy>=this.calcTotalEbuy()){this.pay.egou=this.calcTotalEbuy();var t=this.calcTotalMoney()-this.calcTotalEbuy();this.integeralPay(this.userIntegeral,t)}else{this.pay.egou=this.userEbuy;var i=this.calcTotalMoney()-this.userEbuy;this.integeralPay(this.userIntegeral,i)}else this.integeralPay(this.userIntegeral,this.calcTotalMoney())},integeralPay:function(t,i){t?t>=i?this.pay.ebi=i:(this.pay.ebi=t,this.pay.money=i-t):this.pay.money=i},gotoBuy:function(){var t=[];this.cartList&&this.cartList.forEach(function(i,s){i.check&&t.push(i)}),Object(d.c)("buyPro",t),Object(d.b)("unCheckCartList"),this.$router.push("/orderConfirm")},confirmBtn:function(){var t=this,i=this.checkID.join(",");Object(m.l)({productIds:i}).then(function(i){t.DELETE_CART(t.checkID),t.calcuPay()})},showConfirmDialog:function(){this.showDialog=!0,this.confirmText="确定删除购物车所选内容吗？"},closeConfirmDialog:function(){this.showDialog=!1}}),watch:{$route:"initData"}},v={render:function(){var t=this,i=t.$createElement,c=t._self._c||i;return c("div",[c("div",{staticClass:"cart banner-bt-3"},[t.cartList&&0!=t.cartList.length?t._e():c("div",{staticClass:"nothing"},[c("img",{attrs:{src:s("pkH0")}}),t._v(" "),c("h4",[t._v("购物车暂无内容")])]),t._v(" "),t.cartList.length>0?c("div",{staticClass:"bg-show fixed-top"},[c("div",{staticClass:"border-bottom",staticStyle:{width:"100%",overflow:"hidden"}},[c("div",{staticClass:"fr btn-edit"},[t.edit?c("span",{class:["btn-border",t.checkedCount>0?"":"dis-btn"],on:{click:t.showConfirmDialog}},[t._v("删除")]):t._e(),t._v(" "),c("span",{staticClass:"btn-default",on:{click:function(i){t.editPro()}}},[t._v(t._s(t.edit?"完成":"编辑"))])])])]):t._e(),t._v(" "),t.cartList.length>0?c("ul",{staticClass:"cart-ads flex-layout font-theme"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2)]):t._e(),t._v(" "),t.cartList.length>0?c("ul",{staticClass:"cart-list border-list"},t._l(t.cartList,function(i){return c("li",{key:i.id,staticClass:"list-box"},[c("label",{staticClass:"checkbox checkbox-2"},[c("input",{directives:[{name:"model",rawName:"v-model",value:i.check,expression:"cart.check"}],attrs:{type:"checkbox",name:"checkbox"},domProps:{value:i.check,checked:Array.isArray(i.check)?t._i(i.check,i.check)>-1:i.check},on:{change:[function(s){var c=i.check,e=s.target,a=!!e.checked;if(Array.isArray(c)){var n=i.check,o=t._i(c,n);e.checked?o<0&&t.$set(i,"check",c.concat([n])):o>-1&&t.$set(i,"check",c.slice(0,o).concat(c.slice(o+1)))}else t.$set(i,"check",a)},function(s){t.selectPro(i.productId,i.total,i.check)}]}}),t._v(" "),c("i",{staticClass:"icon-hook"})]),t._v(" "),c("img",{staticClass:"list-img",attrs:{src:t.getImgPath(i.productImg)}}),t._v(" "),c("div",{staticClass:"list-info-v"},[c("div",{staticClass:"list-box"},[c("div",{staticClass:"list-info-v"},[c("div",[c("h5",{staticClass:"nowrap-2"},[t._v("\n                              "+t._s(i.productName)+"\n                            ")]),t._v(" "),c("div",{staticClass:"list-box"},[c("div",{staticClass:"list-info-h price-small"},[c("span",{staticClass:"font-orange"},[c("i",{staticClass:"icon-coin"}),t._v(t._s(i.currCost))]),t._v(" "),c("s",{staticClass:"font-gray"},[t._v("市场价:￥"+t._s(i.currPrice))])]),t._v(" "),c("buy-num",{attrs:{proID:i.productId,proNum:i.total,check:i.check},on:{editNum:t.editNum}})],1)])])])])])})):t._e(),t._v(" "),c("div",{staticClass:"fixed-bottom bg-show"},[t.cartList.length>0?c("div",{staticClass:"cal-banner list-box border-top"},[c("label",{staticClass:"all-check"},[c("input",{directives:[{name:"model",rawName:"v-model",value:t.isCheckAll,expression:"isCheckAll"}],attrs:{type:"checkbox"},domProps:{value:t.checkAllFlag,checked:Array.isArray(t.isCheckAll)?t._i(t.isCheckAll,t.checkAllFlag)>-1:t.isCheckAll},on:{change:[function(i){var s=t.isCheckAll,c=i.target,e=!!c.checked;if(Array.isArray(s)){var a=t.checkAllFlag,n=t._i(s,a);c.checked?n<0&&(t.isCheckAll=s.concat([a])):n>-1&&(t.isCheckAll=s.slice(0,n).concat(s.slice(n+1)))}else t.isCheckAll=e},function(i){t.selectAll()}]}}),t._v(" "),c("i",{staticClass:"icon-hook"}),t._v("\n                全选\n            ")]),t._v(" "),c("p",{staticClass:"sm-font font-gray list-info-v right-text pdr"},[t.pay.egou?c("span",[t._v("e购抵扣"+t._s(t.pay.egou)+"元")]):t._e()]),t._v(" "),c("div",{staticClass:"right-text pdr"},[0!=t.pay.money?c("p",{staticClass:"font-orange"},[t._v("￥"+t._s(t.pay.money))]):t._e(),t._v(" "),0!=t.pay.ebi?c("p",[c("i",{staticClass:"icon-coin"}),t._v(" "),c("span",{staticClass:"font-orange"},[t._v(t._s(t.pay.ebi))])]):t._e()]),t._v(" "),c("p",{class:[{disbtn:0==t.total_price2},"btn-theme"],on:{click:t.gotoBuy}},[t._v("结算("+t._s(t.checkedCount)+")")])]):t._e(),t._v(" "),c("footer-nav")],1)]),t._v(" "),t.showDialog?c("confirm-dialog",{attrs:{"confirm-text":t.confirmText,showBtn:"true",centerText:"true"},on:{closeConfirmDialog:t.closeConfirmDialog,confirmBtn:t.confirmBtn}}):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("li",[i("span",[this._v("48小时内发货")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("li",[i("span",[this._v("所有商品免邮费")])])},function(){var t=this.$createElement,i=this._self._c||t;return i("li",[i("span",[this._v("节假日不发货")])])}]};var _=s("VU/8")(f,v,!1,function(t){s("B1Tu")},"data-v-20279500",null);i.default=_.exports},B1Tu:function(t,i){},fjE2:function(t,i){}});
//# sourceMappingURL=10.a030b5f80da95f255443.js.map